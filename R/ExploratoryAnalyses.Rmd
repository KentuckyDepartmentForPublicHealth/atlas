```{r}
library(dplyr)
library(ggplot2)
library(survival)
```

```{r}
#atlas<-readRDS("C:/Users/henry/Downloads/ExpData.rds")
#mean.frame <- data.frame(colMeans(atlas))
jde.mean<- data.frame(mean.frame[1:170,])
jde.hist <- read.csv("C:/Users/henry/Downloads/hist.csv")
jde.data<- bind_cols(jde.mean,jde.hist)
colnames(jde.data)[colnames(jde.data) == "mean.frame.1.170..."] <- "Mean"
boxplot(Mean ~ Histology, data = jde.data,
        main = "Boxplot by Histology", 
        xlab = "Histology", 
        ylab = "mRNA Expression (log2)")
```



```{r}
jde.surv<- read.csv("C:/Users/henry/Downloads/jde survival.csv")
jde.survival<- jde.surv[, c("Vital.status","Overall.survival..months.","Original.histology"), drop=F]
fit<- survfit(Surv(Overall.survival..months.,Vital.status)~1, data=jde.survival)
plot(fit, xlab="Time", ylab="Survival", main="JDE Data", col=c(1), lty=c(1),conf.int = F)
```


```{r}
jde.survival$Age.Groups <- jde.surv$Age..grouped.
fit2 <- survfit(Surv(Overall.survival..months.,Vital.status)~strata(Age.Groups), data=jde.survival);fit2
plot(fit2, xlab="Time", ylab="Survival", main="JDE Data", col=c(1:4), lty=c(1),conf.int = F)
legend("bottomleft",title = "Age Groups", 0.7, legend=c("10-20","20-40","40-60","60-80"), lty=1, col=1:4)

```












